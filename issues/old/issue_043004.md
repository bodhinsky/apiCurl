Given the file, please extend the code so that the user collection data will be visualized as graphs based on sensible attributes in a pandas context and save the graphs into files and write tests